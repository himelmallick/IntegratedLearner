<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Integrated machine learning for multi-omics prediction and classification • IntegratedLearner</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Integrated machine learning for multi-omics prediction and classification">
<meta property="og:description" content="IntegratedLearner provides an integrated machine learning framework to (1) consolidate predictions by borrowing information across several longitudinal and cross-sectional omics data layers, (2) decipher the mechanistic role of individual omics features that can potentially lead to new sets of testable hypotheses, and (3) quantify uncertainty of the integration process. Three types of integration paradigms are supported; early, late, and intermediate. The software includes multiple ML models based on the SuperLearner R package as well as several data exploration capabilities and visualization modules in a unified estimation framework.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">IntegratedLearner</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/IntegratedLearner.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/himelmallick/IntegratedLearner/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="integratedlearner---integrated-machine-learning-for-multi-omics-prediction-and-classification">IntegratedLearner - Integrated machine learning for multi-omics prediction and classification<a class="anchor" aria-label="anchor" href="#integratedlearner---integrated-machine-learning-for-multi-omics-prediction-and-classification"></a>
</h1></div>
<p>The repository houses the <strong><code>IntegratedLearner</code></strong> R package for multi-omics prediction and classification. Both binary and continuous outcomes are supported.</p>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p><code>IntegratedLearner</code> requires the following <code>R</code> package: <code>devtools</code> (for installation only). Please install it before installing <code>IntegratedLearner</code>, which can be done as follows (execute from within a fresh R session):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Once the dependencies are installed, <code>IntegratedLearner</code> can be loaded using the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"himelmallick/IntegratedLearner"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/himelmallick/IntegratedLearner" class="external-link">IntegratedLearner</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="run-integratedlearner-in-a-container">Run IntegratedLearner in a container<a class="anchor" aria-label="anchor" href="#run-integratedlearner-in-a-container"></a>
</h3>
<p>IntegratedLearner can be run in a containerized environment using either Docker or Podman. It significantly simplifies the installation by ensuring that all the necessary packages are installed to run the provided vignette.</p>
<p>Refer to the installation instructions for your operating system for <a href="https://docs.docker.com/engine/install/" class="external-link">Docker</a> or <a href="https://podman.io/docs/installation" class="external-link">Podman</a>. Then, in the terminal, run</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Pull the container image from the registry</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">docker</span> pull ghcr.io/himelmallick/integratedlearner:master</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Start the container named IntegratedLearner on port 8787</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--port</span> 8787:8787 <span class="at">--name</span> IntegratedLearner integratedlearner:master</span></code></pre></div>
<p>In the browser, navigate to <code>localhost:8787</code> and log in with <code>rstudio</code> username and the password that was displayed in the terminal.</p>
<p>In the R console, write <code>setwd("/opt/pkg")</code>. You can now open any file in the IntegratedLearner repository.</p>
<p>Podman is compatible with Docker commands, therefore <code>docker</code> command can be substituted with <code>podman</code>.</p>
<p><strong>NOTE</strong>: if running rootless Podman, the correct username <em>might be</em> <code>root</code> instead of <code>rstudio</code>.</p>
<div class="section level4">
<h4 id="map-local-directory-to-container-directory">Map local directory to container directory<a class="anchor" aria-label="anchor" href="#map-local-directory-to-container-directory"></a>
</h4>
<p>If you would like to make changes to the code, you need to <em>map</em> the local directory to a directory inside the container. Otherwise, the modifications will be discarded when the container is stopped. To do so, we need to specify a volume option:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-p</span> 8787:8787 <span class="at">-v</span> .:/IntegratedLearner <span class="at">--name</span> IntegratedLearner integratedlearner:master</span></code></pre></div>
<p>In this command, we <em>map</em> the current directory (for example, IntegratedLearner repository) to the <code>/IntegratedLearner</code> directory inside the container. After logging in RStudio Server, in the console, write <code>setwd("/IntegratedLearner")</code> and modify the files. The modifications made <em>inside</em> the container will be persistently saved in the current directory of the host system.</p>
<p><strong>NOTE</strong>: if you are using SELinux (often enabled by default on Fedora), and you receive <em>Permission denied</em> errors when accessing files inside the container, add a <code>:Z</code> flag to the volume option: <code>.:/IntegratedLearner:Z</code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>Supports early, late, and intermediate fusion with one line of code</li>
<li>Dozens of algorithms: Random Forest, LASSO, Elastic Net, SVM, BART, and more</li>
<li>Integrates with <a href="https://cran.r-project.org/web/packages/SuperLearner/index.html" class="external-link">SuperLearner</a> to support even more options to quickly add custom algorithms to the ensemble</li>
<li>Visualization using built-in plotting</li>
<li>Hyperparameter tuning</li>
<li>Screening algorithms</li>
<li>Options to add new algorithms or change the default parameters for existing ones</li>
<li>Nested cross-validation to estimate the performance of the integrated machine learner</li>
<li>Multicore and multinode parallelization for scalability (<strong>Not yet available</strong>)</li>
</ul>
</div>
<div class="section level2">
<h2 id="quickstart-guide">Quickstart Guide<a class="anchor" aria-label="anchor" href="#quickstart-guide"></a>
</h2>
<p>The package vignette demonstrates how to use the <strong>IntegratedLearner</strong> workflow to perform a multi-omics prediction and classification task. This vignette can be viewed online <a href="http://htmlpreview.github.io/?https://github.com/himelmallick/IntegratedLearner/blob/master/vignettes/IntegratedLearner.html" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p><strong><code>IntegratedLearner</code></strong> provides an integrated machine learning framework to 1) consolidate predictions by borrowing information across several longitudinal and cross-sectional omics data layers, 2) decipher the mechanistic role of individual omics features that can potentially lead to new sets of testable hypotheses, and 3) quantify uncertainty of the integration process. Three types of integration paradigms are supported: early, late, and intermediate. The software includes multiple ML models based on the <a href="https://cran.r-project.org/web/packages/SuperLearner/index.html" class="external-link">SuperLearner R package</a> as well as several data exploration capabilities and visualization modules in a unified estimation framework.</p>
<p>At the core, the <strong><code>IntegratedLearner</code></strong> late fusion algorithm proceeds by 1) fitting a machine learning algorithm (<code>base_learner</code>) per-layer to predict outcome and 2) combining the layer-wise cross-validated predictions using a meta model (<code>meta_learner</code>) to generate final predictions based on all available data points. As a default choice, we recommend <a href="https://arxiv.org/abs/0806.3286" class="external-link">Bayesian additive regression trees (BART)</a> as the base learner (<code>base_learner = 'SL.BART'</code>) and non-negative least squares/ rank loss minimization as the meta model algorithm (<code>meta_learner = 'SL.nnls.auc'</code>). <code>'SL.nnls.auc'</code> fits a non-negative least squares (in case of a continuous outcome) and rank loss minimization (in case of binary outcome) on layer-wise cross-validated predictions to generate the final predictions and quantify per-layer contributions.</p>
<p>In addition, &gt;50 ML algorithms are supported. Note that, all the learners must be named such that they are preceeded by the prefix <code>SL.</code> followed by the name of the learner or the associated package (e.g., <code>SL.randomForest</code>, <code>SL.BART</code>, <code>SL.glmnet</code>, etc.). Please check out the <a href="https://cran.r-project.org/web/packages/SuperLearner/vignettes/Guide-to-SuperLearner.html" class="external-link">SuperLearner user manual</a> for all available options.</p>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<pre><code><span><span class="fu"><a href="reference/IntegratedLearner.html">IntegratedLearner</a></span><span class="op">(</span><span class="va">feature_table</span>, <span class="va">sample_metadata</span>, <span class="va">feature_metadata</span>, <span class="va">...</span><span class="op">)</span></span></code></pre>
<div class="section level3">
<h3 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h3>
<ul>
<li>
<code>feature_table</code>: Data frame representing concatenated multi-omics features with features in rows (<code>rownames</code>) and samples in columns (<code>colnames</code>).</li>
<li>
<code>sample_metadata</code>: Data frame of sample-specific metadata. Must have a column named <code>subjectID</code> describing per-subject unique identifiers. For longitudinal designs, this variable is expected to have non-unique values. Additionally, a column named <code>Y</code> must be present which is the outcome of interest (can be binary or continuous). Row names of <code>sample_metadata</code> must match the column names of <code>feature_table</code>.</li>
<li>
<code>feature_metadata</code>: Data frame containing feature-specific metadata. Must have a column named <code>featureID</code> describing per-feature unique identifiers. Additionally, if multiple omics layers are present, a column named <code>featureType</code> should describe the corresponding source layer (e.g. metagenomics, metabolomics, etc.). Row names must match that of <code>feature_table</code>.</li>
<li>
<code>feature_table_valid</code>: Optional feature table from validation set. Must have the exact same structure as <code>feature_table</code>.</li>
<li>
<code>sample_metadata_valid</code>: Optional sample-specific metadata table from independent validation set. Must have the exact same structure as <code>sample_metadata</code>.</li>
<li>
<code>family</code>: A character string representing one of the built-in families. Currently, <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian()</a></code> and <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial()</a></code> are supported.</li>
<li>
<code>folds</code>: Integer. Number of folds for cross-validation. Default is 5.</li>
<li>
<code>base_learner</code>: Character string representing the name of the <code>SL</code> base-learner in stacked generalization and optionally for joint learner (see example). Check out the <a href="https://cran.r-project.org/web/packages/SuperLearner/vignettes/Guide-to-SuperLearner.html" class="external-link">SL user manual</a> for all available options. Default is <code>'SL.BART'</code>
</li>
<li>
<code>meta_learner</code>: Character string representing the name of the <code>SL</code> meta-learner in stacked generalization (see example). Check out the <a href="https://cran.r-project.org/web/packages/SuperLearner/vignettes/Guide-to-SuperLearner.html" class="external-link">SL user manual</a> for all available options. Default is <code>'SL.nnls.auc'</code>
</li>
<li>
<code>run_concat</code>: Logical value representing whether a joint (concatenated) model should also be run (see tutorial). Default is TRUE.</li>
<li>
<code>run_stacked</code>: Logical value representing whether a stacked model should also be run (see tutorial). Default is TRUE.</li>
<li>
<code>print_learner</code>: Logical value representing whether a summary of fit should be printed. Default is TRUE.</li>
<li>
<code>verbose</code>: Logical value for printing progress during the computation (helpful for debugging). Default is FALSE.</li>
<li>
<code>...</code>: Additional arguments for <code>SL</code> tuning parameters.</li>
</ul>
<div class="section level4">
<h4 id="the-integratedlearner-workflow">The IntegratedLearner workflow<a class="anchor" aria-label="anchor" href="#the-integratedlearner-workflow"></a>
</h4>
<div class="float">
<img src="/images/Flowchart.png" alt="Flow Chart"><div class="figcaption">Flow Chart</div>
</div>
</div>
<div class="section level4">
<h4 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h4>
<ul>
<li>
<code>SL_fits</code>: A list of <code>SL</code> prediction results from all individual base learners, the meta learner, and optionally the joint (concatenation) learner.</li>
<li>
<code>model_fits</code>: A list of <code>base_learner</code> objects extracted from <code>SL_fits</code> for all individual base learners, meta learner, and optionally the joint (concatenation) learner.</li>
<li>
<code>X_train_layers</code>: Input feature matrices for individual layers for training data.</li>
<li>
<code>Y_train</code>: Input response vector for training data.</li>
<li>
<code>yhat.train</code>: Predictions for training data from all individual base learners, the meta learner, and optionally the joint (concatenation) learner.</li>
<li>
<code>X_test_layers</code>: Input feature matrices for individual layers for test data. Available if <code>feature_table_valid</code> is provided.</li>
<li>
<code>Y_test</code>: Input response vector for test data.</li>
<li>
<code>weights</code>: Estimated layer weights in the meta model. Available if <code>run_stacked=TRUE</code> and <code>meta_learner='SL.nnls.auc'</code>.</li>
<li>
<code>AUC.train</code>/<code>R2.train</code>: AUC/ R2 metrics calculated on training data using <code>yhat.train</code> and <code>Y_train</code>.</li>
<li>
<code>AUC.test</code>/<code>R2.test</code>: AUC/ R2 metrics calculated on test data using <code>yhat.test</code> and <code>Y_test</code>.</li>
<li>
<code>...</code>: Additional arguments containing information about inputs.</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <code>IntegratedLearner</code> in your work, please cite the following:</p>
<p>Mallick H et al. (2024). <a href="https://onlinelibrary.wiley.com/doi/10.1002/sim.9953" class="external-link">An Integrated Bayesian Framework for Multi-omics Prediction and Classification</a>. <em>Statistics in Medicine</em> 43(5):983–1002.</p>
</div>
<div class="section level2">
<h2 id="issues">Issues<a class="anchor" aria-label="anchor" href="#issues"></a>
</h2>
<p>We are happy to troubleshoot any issues with the package. Please contact the maintainer via email or <a href="https://github.com/himelmallick/IntegratedLearner/issues" class="external-link">open an issue</a> in the GitHub repository.</p>
</div>
<div class="section level2">
<h2 id="future-release">Future Release<a class="anchor" aria-label="anchor" href="#future-release"></a>
</h2>
<p>We are currently in the process of submitting <strong><code>IntegratedLearner</code></strong> to <a href="https://www.bioconductor.org/" class="external-link">Bioconductor</a>. Likewise, please keep an eye out for a future release of <strong><code>IntegratedLearner</code></strong> as an R/Bioconductor package while this repository remains the development version of the package.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/himelmallick/IntegratedLearner/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/himelmallick/IntegratedLearner/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing IntegratedLearner</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Himel Mallick <br><small class="roles"> Author, maintainer </small>   </li>
<li>Anupreet Porwal <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Himel Mallick, Anupreet Porwal.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
